# バージョン管理ルール

## ブランチ作成ルール

原則として[git flow](https://nvie.com/posts/a-successful-git-branching-model/)に準する。

開発中は、`develop`ブランチと`feature`ブランチだけ意識しておけばよい。
`master`や`release`などは開発時は気にしなくてよい。

基本は以下の手順になる。
- `develop`から`feature`ブランチを作成する
- `feature`の開発が終わったら`develop`にマージする
- `feature`が長くなる場合、適宜`develop`からの変更を取り込む

フィーチャーブランチを作成する場合は、`feature/<フィーチャ名>`とすること

`<フィーチャ名>`は作成する機能やストーリーから命名する。
名称から内容が想像がつくような命名が望ましいが、変更内容自体はコミットコメントに記載するので、ブランチ名で区別がつかなくても問題はない。


## developブランチへのマージ

`develop`ブランチには、動作確認が取られ、レビューされたPull Requestだけマージすること。

`develop`ブランチは開発者全員が使用する。このブランチにコンパイルエラーやバグを埋め込むと開発者全員の作業に支障がでる。
例えば、以下のようなコードをpushしてはいけない。

- コンパイルエラーが発生するコード
- 形式エラーとなる設定ファイル（アプリケーションが起動できなくなります）

自分のコミットが原因でエラーが発生していることがわかった場合は、速やかに対応すること。
他の開発者に迷惑をかけないため、コメントアウトなどでも良いので、できるだけ早くエラーを取り除くようにすること。


## featureブランチの寿命

あまりに長く`feature`ブランチを伸ばすと、`develop`ブランチとの差異が大きくなり、
マージ時に不具合が出る可能性がある。
以下のようにして、`develop`との差異が大きくならないようにすること。

- `feature`を小さい単位で開発して`develop`にマージする
- `feature`ブランチが長く伸びる場合は、途中で`develop`の変更を`feature`に取り込む

`feature`ブランチを`develop`ブランチにマージする前に、(`git fetch`, `git pull`するなどして)
`develop`が伸びていないか確認すること。
確認した結果、`develop`との差分が大きい場合は、一度`develop`を`feature`に取り込んで動作確認してから
`develop`にマージすること。


## force push禁止

force pushは禁止とする。

無理にrebaseしようとしないこと。コミットログは汚くなってもかまわない。

`develop`ブランチは、GitHub上の設定でforce push禁止設定とする。

# エビデンスの取得方法（ログとDBダンプ）

## エビデンスの取得前の準備

### ログ

必要に応じてログファイルを削除しておく。
ログファイルは`target/app.log`に出力される。

### カバレッジレポート

必要に応じてカバレッジ計測の中間ファイルを削除しておく。
中間ファイルは`target/jacoco.exec`に出力される。

### DBダンプ

#### テーブル定義一覧を更新

単体テスト用データダンプツール(YoyoTool)のテーブル定義一覧を更新する。
更新は以下の手順で行う。

1. DUMP.xlsmを開く
2. MAINシート画面上部の「テーブル定義取得」をクリックする
3. 表示されたダイアログにedmファイルが存在するディレクトリを指定する。
   `<クローンしたディレクトリ>\common\src\main\resources\entity` になる。
   パスの最後の「\」は不要
4. 取得するテーブルについてI列を「○」に変更する。
   どのテーブルを取得するかは、【020_方式設計/020_開発標準/020_テスト標準/単体テスト標準】の「3.3. 取引単体テストのエビデンス」を参照
5. **DUMP.xlsmを保存する**

#### テスト実行前のデータダンプを取得

1. DUMP.xlsmのMAINシート画面上部の「起動」をクリックする
1. ダンプツールのウインドウが表示される。表示されたウインドウの「シートクリア」をクリックする
1. 「DBダンプ取得」をクリックする
1. DUMPエクスポートをクリックし、ダンプを保存するディレクトリを指定する
1. 右上の「×」をクリックしてウインドウを閉じる


## エビデンスの取得方法

### ログ

ログファイルは`<カレントディレクトリ>/target/app.log`に出力される。
テストケースとの紐づけが分かりにくい場合は、ログファイルを分割するなどの対応をすること。

### カバレッジレポート

カバレッジレポートは`<カレントディレクトリ>/target/site/jacoco`に出力される。

### DBダンプ

#### テスト実行後のデータダンプを取得

取得方法は「[テスト実行前のデータダンプを取得](#テスト実行前のデータダンプを取得)」と同様。
テスト前テスト後のダンプを確認し、想定通りのレコード及びカラムが更新されていることを確認する。
確認したら、更新された箇所のカラムの背景色を黄色に変更して保存する。


## エビデンスの取得後

ファイルサーバーへ保存する。
